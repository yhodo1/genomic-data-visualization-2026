---
layout: post
title:  "HW1"
author: Tavishi
jhed: tbudaga1
categories: [ HW1 ]
image: homework/hw1/hw1_tbudaga1.png
featured: false
---

### 1. What about the data are you trying to make salient through this data visualization? 
I wanted to make the relationship between the genes Timp4 and Vegfc more salient. More specifically, I wanted to determine where both the genes were active to determine where co-expression occurs. 

### 2. What are the data types represented?
The data types represented are spatial data and quantitative data. Spatial data indicates the spots where the genes are co-expressed in the organ and quantitative data is represented by the expression values of the two genes.

### 3. What data encodings (geometric primitives and visual channels) are you choosing to visualize these data types?
The geometric primitives used are areas. The visual channels used are position and color. 

### 4. What Gestalt principles or knowledge about perceptiveness of visual encodings are you using to accomplish this?
The Gestalt prinicple used in this visualization is similarity. Because areas with similar expression values have the same color, you automatically group these similar colored regions together to determine which areas have high or low gene co-expression. 

### 5. Code 
```r
# read in the data file 
data <- read.csv('C:/Users/gtbud/Downloads/Xenium-IRI-ShamR_matrix.csv.gz')

# check the dimensions of the dataset
dim(data)

# checks class of the data and previews the first 5 rows and 5 columns of the data
class(data)
head(data)
data[1:5,1:5]

# gets the spatial coordinates of the data
pos <- data[,c('x', 'y')]
rownames(pos) <- data[,1]
head(pos)

# obtains the gene expression data
gexp <- data[, 4:ncol(data)]
rownames(gexp) <- data[,1]
gexp[1:5,1:5]
dim(gexp)

# obtains library needed for plotting
library(ggplot2)

# data frame for additive co-expression
df <- data.frame(pos,Timp4 = gexp[,'Timp4'], Vegfc = gexp[,'Vegfc'])

# additive co-expression
df$coexpr_add <- df$Timp4 + df$Vegfc

# plotting the additive co-expression 
ggplot(df, aes(x, y, z = coexpr_add)) +
  stat_summary_2d(aes(fill = ..value..), fun = mean, bins = 100) +
  scale_fill_gradient(low = "darkblue", high = "white")+
  labs(title = "Co-expression of the Selected Genes: Timp4 + Vegfc",
       x = "Horizontal Spot in Tissue",
       y = "Vertical Spot in Tissue",
       fill = "Combined Gene Expression")

# Notes
# The beginning part of the code was done in class with Dr. Fan. 
# AI was used to find a function that would allow me to obtain the numerical counts of the genes so I could create the gradient.
